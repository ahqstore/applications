---
import type { AHQStoreApplication } from "ahqstore-types";
import { Image } from "astro:assets";
import { getImage } from "astro:assets";

interface Props {
  application: AHQStoreApplication;
  img: string;
  path: string;
}

const { application, img, path } = Astro.props as Props;

const responsiveWidths = [
  100,
  200,
  284,
  320, // Small mobile
  640, // Medium mobile / Small tablet
  768, // Tablet / Small desktop
  1024, // Desktop
  1280, // Larger Desktop
  // You might want to include a width up to the maximum display size you expect,
  // but avoid going over the actual display size needed.
  // For a 2000x2000 source, consider the actual space the image will occupy on screen.
  // If your hero section is max 1400px wide, no need for widths > 1400px.
  1440, // Example: common max width for hero on larger screens
];

const optiImg = await getImage({
  src: img,
  format: "webp",
  // For LCP, ensure `sizes` attribute is passed to the img tag
  // to help browser pick the right size quickly.
  // This height is for the *output* image. If it's a background, it's just a hint.
  widths: responsiveWidths, // Generate multiple widths
  inferSize: true, // Still useful for the aspect ratio
  quality: 80,
});
---

<div class="w-full h-full flex gap-1 sm:gap-2 registerOnClick" data-path={path}>
  <Image
    class="m-0 size-auto border-none rounded-xl"
    src={optiImg.src}
    srcset={optiImg.srcSet.attribute}
    alt={`Icon for ${application.appDisplayName}`}
    height={optiImg.attributes.height}
    width={optiImg.attributes.width}
    loading="eager"
    decoding="async"
    fetchpriority="high"
  />
  <div class="w-full h-full flex flex-col overflow-hidden gap-1 sm:gap-2">
    <h1
      class="mt-1 sm:mt-2 sm:mb-1 mr-auto sm:m-0 text-sm sm:text-lg md:text-xl font-medium sm:font-bold font-sans"
    >
      {application.appDisplayName}
    </h1>
    <h2 class="overflow-hidden line-clamp-1 sm:line-clamp-2">
      {application.description || "Click to view more"}
    </h2>
  </div>
</div>
